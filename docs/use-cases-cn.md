# zhi 使用场景大全

> 本文档通过真实场景演示 zhi CLI 的各种用法，帮助你快速找到适合自己的工作流。

## 目录

- [一、日常办公场景](#一日常办公场景)
  - [1.1 总结会议纪要](#11-总结会议纪要)
  - [1.2 翻译文档](#12-翻译文档)
  - [1.3 生成周报/日报](#13-生成周报日报)
- [二、开发者场景](#二开发者场景)
  - [2.1 代码审查辅助](#21-代码审查辅助)
  - [2.2 生成 API 文档](#22-生成-api-文档)
  - [2.3 批量处理日志文件](#23-批量处理日志文件)
  - [2.4 生成测试数据](#24-生成测试数据)
- [三、内容创作场景](#三内容创作场景)
  - [3.1 文章摘要与改写](#31-文章摘要与改写)
  - [3.2 多语言内容翻译](#32-多语言内容翻译)
  - [3.3 Markdown 格式化输出](#33-markdown-格式化输出)
- [四、数据处理场景](#四数据处理场景)
  - [4.1 PDF/图片 OCR 提取文字](#41-pdf图片-ocr-提取文字)
  - [4.2 CSV/Excel 数据整理](#42-csvexcel-数据整理)
  - [4.3 网页内容抓取与分析](#43-网页内容抓取与分析)
- [五、自定义技能场景](#五自定义技能场景)
  - [5.1 创建代码评审技能](#51-创建代码评审技能)
  - [5.2 创建邮件草稿技能](#52-创建邮件草稿技能)
  - [5.3 创建数据分析技能](#53-创建数据分析技能)

---

## 一、日常办公场景

### 1.1 总结会议纪要

**场景**：产品评审会结束后，你手头有一份冗长的会议记录文本，需要快速整理成重点明确的纪要发给团队。

**操作步骤**：

使用内置的 `summarize` 技能，一行命令即可完成：

```bash
$ zhi run summarize 产品评审会议记录.txt
```

zhi 读取文件内容后，自动生成结构化摘要并保存到 `zhi-output/` 目录：

```
[file_read] 读取: 产品评审会议记录.txt (12.3KB)
[file_write] 写入: 产品评审会议记录-摘要.md (1.8KB)

文件已保存: zhi-output/产品评审会议记录-摘要.md
```

**预期效果**：输出一份 Markdown 格式的会议纪要，包含关键决策、待办事项和负责人。摘要通常是原文的 10%-20%，重点突出，方便分发。

你也可以在交互模式下操作，给出更具体的要求：

```bash
$ zhi
You [approve]: 帮我总结一下这份会议记录，重点提取待办事项和截止日期
```

zhi 会先读取文件，再按你的要求生成针对性更强的摘要。

---

### 1.2 翻译文档

**场景**：收到一份英文技术规格书，需要翻译成中文给团队评审。

**操作步骤**：

使用内置的 `translate` 技能：

```bash
$ zhi run translate api-specification.md
```

默认翻译为简体中文。如果需要翻译为其他语言，在交互模式下指定：

```bash
$ zhi -c "把 项目介绍.md 翻译成英文，保持 Markdown 格式不变"
```

输出示例：

```
[file_read] 读取: api-specification.md (8.5KB)
[file_write] 写入: api-specification-翻译.md (9.2KB)

文件已保存: zhi-output/api-specification-翻译.md
```

**预期效果**：保留原文档结构（标题层级、代码块、列表）的完整中文翻译。技术术语（如 API、JSON、HTTP）保留英文原词。

也支持中译英：

```bash
$ zhi -c "将 产品需求文档.md 翻译成英文"
```

---

### 1.3 生成周报/日报

**场景**：周五下午需要写一份工作周报，手头有这一周的工作日志和 Git 提交记录。

**操作步骤**：

```bash
$ zhi
You [approve]: 根据本周的工作笔记生成一份周报，包含完成事项、进行中事项和下周计划
```

zhi 会请求读取你的工作笔记文件：

```
[file_read] 读取: 本周工作笔记.md (3.2KB)
  → 允许读取此文件? (y/n) y
[file_write] 写入: 周报-2026-02-23.md (1.5KB)
  → 允许创建此文件? (y/n) y

文件已保存: zhi-output/周报-2026-02-23.md
```

**预期效果**：一份格式规范的周报，按"本周完成"、"进行中"、"下周计划"三个板块组织。

如果需要结合 Git 记录，可以用管道传入：

```bash
$ git log --oneline --since="last monday" | zhi -c "根据这些 Git 提交记录生成本周工作总结"
```

---

## 二、开发者场景

### 2.1 代码审查辅助

**场景**：同事提交了一个 Pull Request，你需要在合并前快速审查代码质量。

**操作步骤**：

```bash
$ zhi
You [approve]: 帮我审查 src/api/handler.py 这个文件，重点关注错误处理和安全问题
```

zhi 读取文件后给出审查意见：

```
[file_read] 读取: src/api/handler.py (5.6KB)

## 代码审查意见

### 问题
1. **第 42 行**: `except Exception` 捕获范围太广，建议改为具体异常类型
2. **第 67 行**: SQL 查询直接拼接用户输入，存在注入风险
3. **第 89 行**: 缺少请求超时设置，可能导致连接挂起

### 建议
- 在 `process_request()` 中添加输入验证
- 对数据库查询使用参数化查询
- 添加请求超时配置（建议 30 秒）

### 亮点
- 日志记录完整，包含上下文信息
- 函数职责单一，结构清晰
```

**预期效果**：从安全性、健壮性、可维护性等维度给出具体的审查意见，指出文件路径和行号。

批量审查多个文件：

```bash
$ zhi -c "审查 src/api/ 目录下的所有 Python 文件，列出关键问题"
```

---

### 2.2 生成 API 文档

**场景**：项目有多个 API 接口，但缺少完整文档，需要根据源码快速生成。

**操作步骤**：

```bash
$ zhi
You [approve]: 读取 src/api/routes.py，根据路由定义和函数签名生成 API 文档
```

输出结果：

```
[file_read] 读取: src/api/routes.py (7.8KB)
[file_write] 写入: api-文档.md (4.2KB)

文件已保存: zhi-output/api-文档.md
```

生成的文档包含每个接口的路径、方法、参数和返回值说明。

**预期效果**：结构化的 Markdown API 文档，包含请求示例和响应格式。可直接作为项目文档使用，也可导入到 Notion 或飞书文档。

---

### 2.3 批量处理日志文件

**场景**：线上服务报错，你需要从大量日志中快速定位问题。

**操作步骤**：

先用 shell 提取关键日志，再让 zhi 分析：

```bash
$ zhi
You [approve]: 分析 app.log 中的错误日志，找出最频繁的错误类型和可能原因
```

```
[file_read] 读取: app.log (45.2KB)

## 错误分析报告

### 错误频率统计
| 错误类型              | 出现次数 | 首次出现       |
| -------------------- | ------- | ------------- |
| ConnectionTimeout    | 47      | 02-23 09:15   |
| DatabaseError        | 12      | 02-23 09:22   |
| ValueError           | 3       | 02-23 10:05   |

### 根因分析
ConnectionTimeout 集中在 09:15-09:30，与数据库服务器维护时间重合。
建议检查数据库连接池配置和重试策略。
```

**预期效果**：从海量日志中提炼出关键信息，按频率排序，并给出初步的根因分析和修复建议。

---

### 2.4 生成测试数据

**场景**：开发新功能时需要一批符合格式要求的测试数据。

**操作步骤**：

生成 CSV 格式的测试数据：

```bash
$ zhi -c "生成 50 条中国用户的测试数据，包含姓名、手机号、城市、注册日期，保存为 CSV"
```

```
[file_write] 写入: 测试用户数据.csv (3.1KB)

文件已保存: zhi-output/测试用户数据.csv
```

生成的 CSV 内容示例：

```csv
姓名,手机号,城市,注册日期
张明,13800138001,北京,2026-01-15
李华,13912345678,上海,2026-02-01
王芳,15011112222,广州,2025-12-20
...
```

也可以生成 JSON 或 Excel 格式：

```bash
$ zhi -c "生成 20 条商品测试数据（名称、价格、库存、分类），保存为 JSON"
$ zhi -c "生成销售报表测试数据，按月份和区域分类，保存为 Excel"
```

**预期效果**：格式正确、内容合理的测试数据文件。手机号、城市等字段符合中国实际格式。

---

## 三、内容创作场景

### 3.1 文章摘要与改写

**场景**：你需要对一篇长文章进行压缩整理，或者调整文风适配不同的发布平台。

**操作步骤**：

生成简短摘要：

```bash
$ zhi run summarize 技术分享文章.md
```

在交互模式下要求改写：

```bash
$ zhi
You [approve]: 读取 技术分享文章.md，用更通俗易懂的语言改写，目标读者是非技术人员
```

```
[file_read] 读取: 技术分享文章.md (6.8KB)
[file_write] 写入: 技术分享-通俗版.md (5.2KB)

文件已保存: zhi-output/技术分享-通俗版.md
```

**预期效果**：在保留核心观点的前提下，调整语言风格和专业术语的使用深度。原始文件不会被修改，改写结果保存为新文件。

---

### 3.2 多语言内容翻译

**场景**：公司产品需要同时发布中文和英文版本的更新日志。

**操作步骤**：

```bash
$ zhi -c "读取 更新日志-v2.5.md，翻译成英文，保持 Markdown 格式和版本号不变"
```

```
[file_read] 读取: 更新日志-v2.5.md (2.1KB)
[file_write] 写入: changelog-v2.5-en.md (2.3KB)

文件已保存: zhi-output/changelog-v2.5-en.md
```

原文示例：

```markdown
## v2.5.0 更新日志

### 新增功能
- 支持暗色模式
- 新增数据导出为 PDF 格式
```

翻译结果：

```markdown
## v2.5.0 Changelog

### New Features
- Added dark mode support
- Added data export to PDF format
```

**预期效果**：翻译准确流畅，格式完全保留。版本号、代码片段、变量名等不被翻译。

---

### 3.3 Markdown 格式化输出

**场景**：需要将零散的笔记整理成结构化的 Markdown 文档。

**操作步骤**：

```bash
$ zhi
You [approve]: 读取 会议笔记-原始.txt，整理成格式规范的 Markdown 文档，添加标题层级和列表
```

```
[file_read] 读取: 会议笔记-原始.txt (1.8KB)
[file_write] 写入: 会议笔记-整理.md (2.0KB)

文件已保存: zhi-output/会议笔记-整理.md
```

**预期效果**：结构清晰的 Markdown 文件，包含正确的标题层级（`#`, `##`, `###`）、有序/无序列表、引用块等元素。可直接粘贴到飞书、Notion 或 GitHub。

---

## 四、数据处理场景

### 4.1 PDF/图片 OCR 提取文字

**场景**：拿到一份扫描版的合同 PDF 或手写会议白板照片，需要将内容转为可编辑的文本。

**操作步骤**：

PDF 文件提取：

```bash
$ zhi -c "用 OCR 识别 合同扫描件.pdf 中的文字，保存为文本文件"
```

```
[ocr] 识别: 合同扫描件.pdf (3.2MB)
[file_write] 写入: 合同内容.txt (8.5KB)

文件已保存: zhi-output/合同内容.txt
```

图片文字识别：

```bash
$ zhi -c "识别 白板照片.jpg 中的文字内容，整理成条目列表"
```

```
[ocr] 识别: 白板照片.jpg (2.1MB)
[file_write] 写入: 白板内容.md (1.2KB)

文件已保存: zhi-output/白板内容.md
```

**预期效果**：从 PDF 或图片中提取文字，并按要求整理格式。支持的格式包括 PDF、PNG、JPG、GIF、WEBP，文件大小上限 20MB。

批量处理多张图片：

```bash
$ zhi
You [approve]: 依次识别 截图1.png 和 截图2.png 的文字内容，合并整理成一个文档
```

---

### 4.2 CSV/Excel 数据整理

**场景**：手头有一份混乱的 CSV 数据，需要清洗整理后输出为 Excel 格式。

**操作步骤**：

```bash
$ zhi
You [approve]: 读取 销售数据-原始.csv，按地区汇总销售额，生成新的 Excel 文件
```

```
[file_read] 读取: 销售数据-原始.csv (15.6KB)
[file_write] 写入: 销售汇总-按地区.xlsx (4.8KB)

文件已保存: zhi-output/销售汇总-按地区.xlsx
```

生成的 Excel 包含汇总表格：

| 地区   | 总销售额    | 订单数 | 平均客单价 |
| ------ | ---------- | ------ | --------- |
| 华东   | 1,250,000  | 320    | 3,906     |
| 华南   | 980,000    | 245    | 4,000     |
| 华北   | 870,000    | 210    | 4,143     |

也支持 CSV 到 CSV 的处理：

```bash
$ zhi -c "读取 用户列表.csv，去除重复项，按注册日期排序，保存为新的 CSV"
```

**预期效果**：数据经过清洗、汇总或转换后保存为指定格式。Excel 文件需要安装 `openpyxl`（`pip install zhicli[all]`），否则自动降级输出为 CSV。

---

### 4.3 网页内容抓取与分析

**场景**：需要从某个网页获取信息并整理成报告。

**操作步骤**：

```bash
$ zhi
You [approve]: 抓取 https://example.com/tech-trends-2026 的内容，提取要点并整理成中文摘要
```

```
[web_fetch] 抓取: https://example.com/tech-trends-2026 (28.5KB)
[file_write] 写入: 技术趋势摘要.md (2.1KB)

文件已保存: zhi-output/技术趋势摘要.md
```

**预期效果**：从网页中提取正文内容，去除广告和导航元素，生成结构化的中文摘要。网页内容上限 50KB，超出部分自动截断。

结合翻译使用：

```bash
$ zhi -c "抓取 https://example.com/release-notes 的内容，翻译成中文并保存"
```

---

## 五、自定义技能场景

zhi 支持通过 YAML 文件定义自定义技能。技能一旦创建，就可以像内置功能一样反复使用。技能使用 `glm-4-flash` 模型执行，成本仅为交互聊天的 10%。

### 5.1 创建代码评审技能

**场景**：团队需要一个统一的代码评审标准，每次评审时执行相同的检查清单。

**操作步骤**：

在交互模式中让 zhi 创建技能：

```bash
$ zhi
You [approve]: 帮我创建一个代码评审技能，要求检查以下方面：\
...  错误处理是否完善、是否存在安全漏洞、命名是否规范、\
...  是否有重复代码、性能是否有明显问题
```

zhi 生成技能配置文件：

```
[skill_create] 创建技能: code-review
  → 允许创建此技能? (y/n) y

技能 'code-review' 已创建
```

生成的 YAML 文件（`~/.config/zhi/skills/code-review.yaml`）：

```yaml
name: code-review
description: 按团队标准进行代码评审
model: glm-4-flash
system_prompt: |
  你是一位资深代码审查员。按以下清单逐项检查代码：
  1. 错误处理：是否捕获了合适的异常，是否有裸 except
  2. 安全性：是否存在注入、XSS、敏感信息泄露等问题
  3. 命名规范：变量名和函数名是否清晰、一致
  4. 代码重复：是否有可以抽取的公共逻辑
  5. 性能：是否有明显的 N+1 查询、不必要的循环等
  对每个问题给出具体的文件位置和修改建议。
tools:
  - file_read
  - file_write
max_turns: 10
```

使用该技能：

```bash
$ zhi run code-review src/services/user_service.py
```

**预期效果**：每次代码评审都遵循统一标准，输出格式一致的评审报告。新团队成员也能快速上手评审流程。

---

### 5.2 创建邮件草稿技能

**场景**：每天需要发送多封格式类似的工作邮件，希望自动生成草稿。

**操作步骤**：

```bash
$ zhi
You [approve]: 创建一个邮件草稿技能，能根据简要描述生成正式的工作邮件，包含称呼、正文和结尾
```

```
[skill_create] 创建技能: email-draft
  → 允许创建此技能? (y/n) y

技能 'email-draft' 已创建
```

生成的 YAML：

```yaml
name: email-draft
description: 根据简要描述生成正式工作邮件草稿
model: glm-4-flash
system_prompt: |
  你是一位专业的商务邮件撰写助手。根据用户提供的要点生成完整邮件：
  - 使用恰当的称呼（尊敬的/亲爱的 + 对方称谓）
  - 正文条理清晰，语气正式但不生硬
  - 包含礼貌的结尾语
  - 如涉及时间节点，明确标注日期
  将邮件保存为 .txt 文件。
tools:
  - file_write
max_turns: 5
```

使用示例：

```bash
$ zhi -c "用 email-draft 技能写一封邮件：告知客户王总项目验收时间推迟到下周三"
```

**预期效果**：一键生成格式规范的邮件草稿，可直接复制粘贴到邮件客户端。

---

### 5.3 创建数据分析技能

**场景**：每月需要对销售数据做固定格式的分析报告。

**操作步骤**：

```bash
$ zhi
You [approve]: 创建一个月度数据分析技能，功能包括：读取 CSV 数据、\
...  计算环比增长、按维度汇总、生成 Markdown 报告和 Excel 汇总表
```

```
[skill_create] 创建技能: monthly-report
  → 允许创建此技能? (y/n) y

技能 'monthly-report' 已创建
```

生成的 YAML：

```yaml
name: monthly-report
description: 读取销售 CSV 数据并生成月度分析报告
model: glm-4-flash
system_prompt: |
  你是一位数据分析师。对提供的销售数据执行以下分析：
  1. 计算本月总销售额及环比变化
  2. 按产品类别和地区维度分别汇总
  3. 找出 Top 5 畅销产品和增长最快的品类
  4. 生成一份 Markdown 分析报告（含数据表格）
  5. 同时生成一份 Excel 汇总表
  所有数值保留两位小数，金额使用人民币符号。
tools:
  - file_read
  - file_write
max_turns: 10
```

使用该技能：

```bash
$ zhi run monthly-report 2026年1月销售数据.csv
```

输出：

```
[file_read] 读取: 2026年1月销售数据.csv (25.6KB)
[file_write] 写入: 月度分析报告-2026-01.md (3.8KB)
[file_write] 写入: 月度汇总表-2026-01.xlsx (5.2KB)

文件已保存:
  zhi-output/月度分析报告-2026-01.md
  zhi-output/月度汇总表-2026-01.xlsx
```

**预期效果**：每月只需一行命令，即可生成完整的分析报告和 Excel 数据表。报告格式固定、口径统一，适合直接提交给管理层。

---

## 附录：常用命令速查

| 操作 | 命令 |
| --- | --- |
| 启动交互模式 | `zhi` |
| 单次提问 | `zhi -c "你的问题"` |
| 管道输入 | `cat 文件.txt \| zhi -c "总结这段内容"` |
| 运行技能 | `zhi run <技能名> [文件...]` |
| 首次配置 | `zhi --setup` |
| 查看版本 | `zhi --version` |
| 调试模式 | `zhi --debug` |

### 交互模式下的斜杠命令

| 命令 | 说明 |
| --- | --- |
| `/help` | 查看帮助信息 |
| `/model glm-5` | 切换到 GLM-5 模型（更智能、更贵） |
| `/model glm-4-flash` | 切换到 GLM-4-flash（更快、更便宜） |
| `/auto` | 自动模式（跳过工具确认弹窗） |
| `/approve` | 审批模式（默认，每次工具调用都需确认） |
| `/think` | 开启思考模式（仅 GLM-5 支持） |
| `/fast` | 关闭思考模式 |
| `/run <技能> [文件]` | 在交互模式内运行技能 |
| `/skill list` | 列出已安装的技能 |
| `/skill new` | 创建新技能 |
| `/reset` | 清空对话历史 |
| `/undo` | 撤销最近一轮对话 |
| `/usage` | 查看当前会话的 Token 用量 |
| `/exit` | 退出 zhi |

### 安全提示

- **所有文件写入**都保存到 `zhi-output/` 目录，不会修改你的原始文件
- **Shell 命令**每次执行前都需要手动确认（即使在 `/auto` 模式下）
- **危险命令**（`rm`、`mv` 等）会显示额外警告
- **灾难性命令**（`rm -rf /` 等）被完全禁止执行
- **OCR 文件**大小上限 20MB
- **技能名称**只允许字母、数字、连字符和下划线
